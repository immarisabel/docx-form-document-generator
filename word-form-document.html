<!DOCTYPE html>
<html>

<head>
  <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
</head>

<body>
  <h1>DOCX browser Word document generation</h1>

  <form id="myForm">
    <h2>Date:</h2>
    <input type="date" id="dateInput" name="dateInput"><br><br>

    <h2>Checkboxes:</h2>
    <input type="checkbox" id="checkbox1" name="checkbox1">
    <label for="checkbox1">Option 1</label><br>
    <input type="checkbox" id="checkbox2" name="checkbox2">
    <label for="checkbox2">Option 2</label><br>
    <input type="checkbox" id="checkbox3" name="checkbox3">
    <label for="checkbox3">Option 3</label><br><br>

    <h2>Text Box:</h2>
    <textarea id="textInput" name="textInput" rows="4" cols="50"></textarea><br><br>

    <input type="button" value="Generate Document" onclick="generate()">
  </form>

  <script>
    function formatDate(date) {
      const year = date.getFullYear();
      let month = (date.getMonth() + 1).toString();
      let day = date.getDate().toString();

      if (month.length === 1) {
        month = '0' + month;
      }

      if (day.length === 1) {
        day = '0' + day;
      }

      return day + '/' + month + '/' + year;
    }

    function generate() {
      const dateInput = document.getElementById("dateInput").value;
      const formattedDate = formatDate(new Date(dateInput));
      const checkbox1 = document.getElementById("checkbox1").checked ? "Option 1" : "";
      const checkbox2 = document.getElementById("checkbox2").checked ? "Option 2" : "";
      const checkbox3 = document.getElementById("checkbox3").checked ? "Option 3" : "";
      const textInput = document.getElementById("textInput").value;

      const doc = new docx.Document({
        sections: [{
          properties: {},
          children: [
            new docx.Paragraph({
              children: [
                new docx.TextRun("Date: " + formattedDate),
              ],
            }),
            new docx.Paragraph({
              children: [
                new docx.TextRun("Checkboxes: " + checkbox1 + "|" + checkbox2 + checkbox3),
              ],
            }),
            new docx.Paragraph({
              children: [
                new docx.TextRun("Text: " + textInput),
              ],
            }),
          ],
        }]
      });

      const fileName = "meeting_" + formattedDate.replaceAll('/', '_') + ".docx";

      docx.Packer.toBlob(doc).then(blob => {
        saveAs(blob, fileName);
        console.log("Document created successfully");
      });
    }
  </script>

</body>

</html>
